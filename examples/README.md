# fst-reader Examples

## fst-filter

A command-line tool for inspecting and filtering FST waveform files. Uses optimized raw block copying to filter signals without decompressing value change data.

### Installation

```sh
cargo build --release --example fst-filter
```

The binary will be at `target/release/examples/fst-filter`.

### Usage

```
fst-filter [OPTIONS] <INPUT> [PATH]...
```

### Display File Metadata

Show header information, timing, signal counts, and VC block summary:

```sh
cargo run --release --example fst-filter -- --info fsts/verilator/swerv1.vcd.fst
```

Output:
```
FST File Information
====================
Version:      Generated by VerilatedVcd
Date:         Sun Nov  1 15:11:15 2020

Timescale:    1 ps
Start time:   0 (0 s)
End time:     13675 (13.675 ns)
Duration:     13.675 ns
Variables:    30659
Signals:      7916
VC blocks:    1

VC Block Summary:
  Block   0: 0 s - 13.675 ns (offset 0x0000014b)
```

### Browse Hierarchy

Display the signal hierarchy tree (scopes only by default):

```sh
# Full hierarchy (scopes only)
cargo run --release --example fst-filter -- input.fst --hierarchy

# Limit depth (e.g., top 3 levels)
cargo run --release --example fst-filter -- input.fst --hierarchy --max-depth 3

# Include signals in the hierarchy view
cargo run --release --example fst-filter -- input.fst --hierarchy --with-signals

# Flat output for copy/paste (dot-joined paths)
cargo run --release --example fst-filter -- input.fst --hierarchy --flat
```

### Filter Hierarchy Display

Use glob or regex patterns to filter what's shown:

```sh
# Substring match (default)
cargo run --release --example fst-filter -- input.fst --hierarchy cpu

# Glob pattern
cargo run --release --example fst-filter -- input.fst --hierarchy -g "top.cpu.*"

# Regex pattern
cargo run --release --example fst-filter -- input.fst --hierarchy -e "axi4_.*valid"
```

### Create Filtered FST Files

Extract specific signals to a new FST file. This uses raw block copying for maximum performance - compressed value change data is copied directly without decompression.

```sh
# Filter by substring match (default)
cargo run --release --example fst-filter -- input.fst -o output.fst clk

# Multiple patterns (OR logic)
cargo run --release --example fst-filter -- input.fst -o output.fst clk reset valid

# Glob pattern matching
cargo run --release --example fst-filter -- input.fst -o output.fst -g "top.cpu.*"

# Regex pattern matching
cargo run --release --example fst-filter -- input.fst -o output.fst -e "axi4_(ar|aw).*"

# Quiet mode (minimal output)
cargo run --release --example fst-filter -- input.fst -o output.fst -q clk
```

### Options Reference

| Option | Description |
|--------|-------------|
| `-o, --output <FILE>` | Output FST file (required for filtering) |
| `--info` | Display file metadata |
| `--hierarchy` | Display hierarchy tree |
| `--max-depth <N>` | Maximum depth for hierarchy display (0 = unlimited) |
| `--with-signals` | Include signals in hierarchy display (default: scopes only) |
| `--flat` | Show hierarchy as flat dot-joined paths (for copy/paste) |
| `-g, --glob` | Match paths using glob patterns |
| `-e, --regex` | Match paths using regex patterns |
| `-q, --quiet` | Quiet mode - minimal output |
| `-h, --help` | Print help |
| `-V, --version` | Print version |

### Examples

```sh
# Inspect a large FST file
fst-filter waves.fst --info

# Browse top-level scopes
fst-filter waves.fst --hierarchy --max-depth 2

# Find all DDR-related scopes (flat output for copy/paste)
fst-filter waves.fst --hierarchy --flat ddr

# Find all AXI signals
fst-filter waves.fst --hierarchy --with-signals -e "axi.*"

# Extract clock and reset signals
fst-filter waves.fst -o clocks.fst clk reset

# Extract an entire subsystem
fst-filter waves.fst -o cpu.fst -g "top.chip.cpu.*"

# Combine info display with filtering
fst-filter waves.fst --info -o filtered.fst ddr
```
