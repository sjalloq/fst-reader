FROM ghcr.io/cross-rs/aarch64-unknown-linux-musl:latest

# Build zlib from source into the musl sysroot
RUN cd /tmp && \
    curl -L https://zlib.net/zlib-1.3.1.tar.gz | tar xz && \
    cd zlib-1.3.1 && \
    CC=aarch64-linux-musl-gcc ./configure --prefix=/usr/local/aarch64-linux-musl --static && \
    make -j$(nproc) && make install && \
    cd / && rm -rf /tmp/zlib-1.3.1
